---
title: "Electric Vehicle Pricing"
author: "Eric Wilson; Min Thiha Myo; Kevin Maldonado"
date: "12/7/2021"
output:
  pdf_document: default
  html_document: default
---

# Introduction

Electric Vehicles are rising in popularity amongst consumers in todays day and age. With climate change playing a big factor,
several nations have made a consorted effort in investing in 'green technologies' which include electric vehicles. The development
and improvement of battery technology has made the electric vehicle a viable and perhaps a more preferable choice for consumers.
Some of the advantages of electric vehicles include saving money on gas, environmentally friendly, low maintenance cost. Local 
governments are also offering incentives to buy an electric vehicle. As there is with any new technology, there are challenges 
that electric vehicles face. Charging station scarcity and battery range are 2 big hurdles that owners will have to face. Despite
the challenges that owners and manufactures might have to overcome, the rise of ownership of electric vehicles is undeniable and
will only increase heading into the future. 

Our project will take data from various electric vehicles that are available in the market and from that data we will perform a regression analysis
to predict the price of electric vehicles based on different variables such as battery size, acceleration, range and efficiency. 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(MASS)
library(car)
```

# Data Preparation

## Data Source
Our data can be found through this link: https://www.kaggle.com/kkhandekar/cheapest-electric-cars

##Loading Dataset
Our EV dataset contains 180 observations (rows) and 12 variables (columns). 
```{r}
ev <- read_xlsx('Electric Vehicle Data/Cheapestelectriccars-EVDatabase.xlsx', 
                sheet = 'Cheapestelectriccars- UTF8')
```

## Data Cleanup
We now go into our data and start our clean up process. We start by converting several variables to numeric. Battery Size, PriceinUK, 
Acceleration, Top Speed, Range, Efficiency, Fast charge speed, and Price in Germany all get converted to numeric. Along with this conversion,
we perform some regex (regular expression) to our data so that we can perform a successful conversion to numeric. Our 'Drive' variable will 
be converted to a factor. Note that since our data set comes from european sources the units will be in kilometers.
```{r}
# Convert Character Vectors into useable numeric vectors
ev$BatterySize <- as.numeric(gsub(".* ([0-9]{2,3}[.]*[0-9]*) kWh", "\\1", ev$Subtitle))
libra_strip <- gsub(".([0-9]{2,3},[0-9]{3})", "\\1", ev$PriceinUK) # strip the libra symbol
ev$PriceinUK <- as.numeric(gsub(",", "", libra_strip))
ev$Acceleration <- as.numeric(gsub(" sec", "", ev$Acceleration))
ev$TopSpeed <- as.numeric(gsub(" km/h", "", ev$TopSpeed))
ev$Range <- as.numeric(gsub(" km", "", ev$Range))
ev$Efficiency <- as.numeric(gsub(" Wh/km", "", ev$Efficiency))
ev$FastChargeSpeed <- as.numeric(gsub(" km/h", "", ev$FastChargeSpeed))
ev$Drive <- as.factor(ev$Drive)
ev$PriceinGermany <- as.numeric(ev$PriceinGermany)
```
We then check for any missing values in our data set and remove them.
```{r}
# Limit ev to complete records, German Prices
ev <- ev[complete.cases(cbind(ev$FastChargeSpeed, ev$PriceinGermany)),]
attach(ev)
```

# Exploratory Data Analysis
Let's to a look at our data set now that we have removed missing values and cleaned it up.
```{r}
head(ev)
```
We have data available for EV prices in Germany (in euros) and prices in the UK (pound sterling ), but for the purpose of this report
we will only be using prices in Germany as our response variable since it provides more data points.

## Summary of Variables
```{r}
#summary of Battery Size
summary(BatterySize)
```
```{r}
#summary of EV prices in Germany
summary(PriceinGermany)
```

```{r}
#summary of Top speed
summary(TopSpeed)
```

```{r}
#summary of Battery Range
summary(Range)
```
The electric vehicles in our data set range in price from €20,490 to €215,000 with an average price of €59,645.
Battery size ranges from 23.8kWh to 200kWh with an average battery size of 66.73kWh
The battery range ranges from 165km to 970km
Top speed ranges from 123km/h to 410km/h with an average top speed of 177.7km/h

## Correlation
```{r}
```







