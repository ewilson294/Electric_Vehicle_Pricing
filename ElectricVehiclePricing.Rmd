---
title: "Electric Vehicle Pricing"
author: "Eric Wilson; Min Thiha Myo; Kevin Maldonado"
date: "12/7/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(MASS)
library(car)
```
Introduction

Electric Vehicles are rising in popularity amongst consumers in todays day and age. With climate change playing a big factor,
several nations have made a consorted effort in investing in 'green technologies' which include electric vehicles. The development
and improvement of battery technology has made the electric vehicle a viable and perhaps a more preferable choice for consumers.
Some of the advantages of electric vehicles include saving money on gas, environmentally friendly, low maintenance cost. Local 
governments are also offering incentives to buy an electric vehicle. As there is with any new technology, there are challenges 
that electric vehicles face. Charging station scarcity and battery range are 2 big hurdles that owners will have to face. Despite
the challenges that owners and manufactures might have to overcome, the rise of ownership of electric vehicles is undeniable and
will only increase heading into the future. 

Our project will take data from various electric vehicles that are available in the market and from that data we will perform a regression analysis
to predict the price of electric vehicles based on different variables such as battery size, acceleration, range and efficiency. 



```{r}
ev <- read_xlsx('Electric Vehicle Data/Cheapestelectriccars-EVDatabase.xlsx', 
                sheet = 'Cheapestelectriccars- UTF8')
```

```{r}
# Convert Character Vectors into useable numeric vectors
ev$BatterySize <- as.numeric(gsub(".* ([0-9]{2,3}[.]*[0-9]*) kWh", "\\1", ev$Subtitle))
libra_strip <- gsub(".([0-9]{2,3},[0-9]{3})", "\\1", ev$PriceinUK) # strip the libra symbol
ev$PriceinUK <- as.numeric(gsub(",", "", libra_strip))
ev$Acceleration <- as.numeric(gsub(" sec", "", ev$Acceleration))
ev$TopSpeed <- as.numeric(gsub(" km/h", "", ev$TopSpeed))
ev$Range <- as.numeric(gsub(" km", "", ev$Range))
ev$Efficiency <- as.numeric(gsub(" Wh/km", "", ev$Efficiency))
ev$FastChargeSpeed <- as.numeric(gsub(" km/h", "", ev$FastChargeSpeed))
ev$Drive <- as.factor(ev$Drive)
ev$PriceinGermany <- as.numeric(ev$PriceinGermany)
```

```{r}
# Limit ev to complete records, German Prices
ev <- ev[complete.cases(cbind(ev$FastChargeSpeed, ev$PriceinGermany)),]
```